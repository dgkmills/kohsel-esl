<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lesson 22: Expressing Opinions - Transformer Team Portal</title>
  <script type="module" src="js/firebase-init.js"></script>
  <script type="module" src="js/protect.js"></script>
  <link rel="stylesheet" href="css/style.css">
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="images/icon-192.png" type="image/png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Learning Portal">
  <link rel="apple-touch-icon" href="images/icon-192.png">
  <style>
    body.auth-loading { display: none; }
    .slideshow-container {
      position: relative;
      background-color: #fff;
      border: 1px solid #d1d5db;
      border-radius: 0.75rem;
      padding: 2rem;
      margin-top: 1.5rem;
      min-height: 500px; 
      display: flex;
      flex-direction: column;
      box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    }
    .slide {
      display: none;
      flex-grow: 1;
      /* --- LARGE FONT STYLES --- */
      line-height: 1.8;
      font-size: 1.25rem; /* 20px base */
    }
    .slide.active { display: block; }
    .slide h3 {
      margin-top: 0;
      margin-bottom: 1rem;
      font-size: 1.75rem; /* 28px */
      font-weight: 600;
    }
    .slide p { margin-bottom: 1rem; }
    .slide ul {
      list-style: disc;
      margin-left: 1.5rem;
      margin-bottom: 1rem;
    }
    .slide li { margin-bottom: 0.5rem; }
    .slide strong {
      color: #4f46e5;
      font-weight: 600;
    }
    .slide code {
      background-color: #eef2ff;
      color: #4338ca;
      padding: 0.125rem 0.375rem;
      border-radius: 0.25rem;
      font-family: monospace;
      font-size: 1.1em;
    }
    .slide-nav {
      margin-top: 1.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-top: 1px solid #e5e7eb;
      padding-top: 1rem;
    }
    .slide-nav button,
    .slide-nav a.button-link { 
        padding: 0.625rem 1.125rem; 
        background-color: #4f46e5;
        color: white;
        border: none;
        border-radius: 0.375rem;
        font-size: 0.875rem;
        font-weight: 600;
        cursor: pointer;
        transition: background-color 0.3s ease;
        text-decoration: none;
        text-align: center;
        display: inline-block;
        margin-top: 0.5rem; 
    }
    .slide-nav button:hover,
    .slide-nav a.button-link:hover { background-color: #4338ca; }
    .slide-nav button:disabled {
      background-color: #9ca3af;
      cursor: not-allowed;
    }
    .slide-nav span {
      font-size: 0.875rem;
      color: #6b7280;
    }
    .slide img.placeholder-image {
        max-width: 100%;
        height: auto;
        border-radius: 0.5rem;
        margin-top: 1rem;
        margin-bottom: 1rem;
        border: 1px solid #e5e7eb;
        display: block;
        margin-left: auto;
        margin-right: auto;
    }
    /* Styles for the reveal logic */
    .revealable-text {
        display: none;
        padding-left: 0.5rem;
        color: #374151; /* text-gray-700 */
    }
    .reveal-controls button {
        margin-right: 0.5rem;
        margin-bottom: 0.5rem;
        background-color: #e0e7ff; /* bg-indigo-100 */
        color: #4338ca; /* text-indigo-700 */
        border: 1px solid #c7d2fe; /* border-indigo-200 */
        padding: 0.4rem 0.8rem;
        border-radius: 0.375rem;
        font-size: 0.9rem;
        font-weight: 600;
        cursor: pointer;
    }
    .reveal-controls button:hover {
        background-color: #c7d2fe;
    }
    .reveal-container {
        margin-top: 1rem;
        padding: 1rem;
        border-left: 4px solid #4f46e5;
        background-color: #f7f7ff;
        border-radius: 0.375rem;
    }
    /* Good for columns */
    .phrase-list {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1.5rem;
    }
    @media (min-width: 768px) { /* md: */
        .phrase-list {
            grid-template-columns: 1fr 1fr; /* 2 columns on medium screens and up */
        }
    }
    .phrase-list h4 {
        margin-top: 0;
        margin-bottom: 0.5rem;
        font-weight: 700;
        font-size: 1.25rem; /* 20px */
    }
    .topic-disagree {
        background-color: #fee2e2; /* bg-red-100 */
        border-left: 4px solid #dc2626; /* border-red-600 */
        padding: 1rem;
        border-radius: 0.375rem;
    }
    /* Styles for modal */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.4);
    }
    .modal-content {
      background-color: #fefefe;
      margin: 15% auto;
      padding: 20px;
      border: 1px solid #888;
      width: 80%;
      max-width: 500px;
      border-radius: 0.75rem;
      box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    }
    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
    }
    .close:hover,
    .close:focus {
      color: #000;
      text-decoration: none;
      cursor: pointer;
    }

    /* Audio button style */
     .audio-button {
      background: #4f46e5;
      color: white;
      border: none;
      padding: 0.25rem 0.5rem;
      margin-left: 0.5rem;
      cursor: pointer;
      vertical-align: middle;
      font-size: 0.9rem;
      border-radius: 0.25rem;
      transition: background-color 0.2s ease;
      white-space: nowrap;
    }
    .audio-button:hover {
      background-color: #4338ca;
    }
    .audio-button:disabled {
      background-color: #9ca3af;
      cursor: not-allowed;
    }

  </style>
</head>
<body class="auth-loading">

  <header>
    <div class="logo-container">
      <img src="images/icon-192.png" alt="Portal Logo">
      <h1>Transformer Team Portal</h1>
    </div>
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="lessons.html" class="active">Lessons</a></li>
        <li><a href="videos.html">Videos</a></li>
        <li><a href="tools.html">Tools</a></li>
        <li id="dashboard-nav-link" style="display: none;"><a href="dashboard.html">Dashboard</a></li>
        <li><button id="logout-button">Logout</button></li>
      </ul>
    </nav>
  </header>

  <main class="container">
    <h2>Lesson 22: Expressing Opinions and Disagreeing Politely</h2>

    <div class="slideshow-container">

      <!-- Slide 1: Review -->
      <div class="slide active" id="slide1">
        <h3>I. Review: Small Talk</h3>
        <p>Let's warm up! Remember "Small Talk" from Lesson 21.</p>
        <p><strong>Quick Challenge:</strong> Pair up. Imagine you are both waiting for the elevator. Start a 1-minute "small talk" conversation.</p>
        
        <img src="images/lesson-22-slide1-review.png"
             alt="Graphic of two colleagues talking by an elevator"
             class="placeholder-image"
             style="max-width: 400px;"
             onerror="this.src='https://placehold.co/400x200/cccccc/ffffff?text=Small+Talk+Review'; this.alt='Error loading image';">

        <p>What "safe" topics did you use? (Weather? Weekend?)</p>
        <p>
            Today, we will learn what to do when your "small talk" becomes a "big talk" and you have a 
            <button class="audio-button" onclick="showModal('opinionModal')">different opinion</button>.
        </p>
      </div>

      <!-- Slide 2: Introduction -->
      <div class="slide" id="slide2">
        <h3>II. Introduction: Polite Disagreement</h3>
        <p>
          At work, we often have different opinions. This is normal and **good**! Different opinions help us find the best solution.
        </p>
         
        <img src="images/lesson-22-slide2-intro.png"
             alt="Illustration of colleagues having a polite debate at a meeting table"
             class="placeholder-image"
             style="max-width: 500px;"
             onerror="this.src='https://placehold.co/500x250/cccccc/ffffff?text=Polite+Debate'; this.alt='Error loading image';">
        
        <p>
            Why is it important to disagree **politely**? We will discuss this in class, but first, try to think of the reasons yourself!
        </p>

        <div class="reveal-container">
            <h4>Reasons (Click to reveal one at a time):</h4>
            <div class="reveal-controls" id="slide2-controls">
                <button onclick="revealNext('slide2-reveals')">Reveal Next Point</button>
            </div>
            <ul id="slide2-reveals" style="list-style: none; padding-left: 0;">
                <li class="revealable-text" data-order="1">**1.** It shows **respect** for your colleagues.</li>
                <li class="revealable-text" data-order="2">**2.** It keeps the conversation **professional**.</li>
                <li class="revealable-text" data-order="3">**3.** It helps you focus on the **problem**, not the person.</li>
                <li class="revealable-text" data-order="4">**4.** It helps build trust.</li>
                <li class="revealable-text" data-order="5" style="margin-top: 1rem; border-top: 1px solid #e5e7eb; padding-top: 0.5rem; font-style: italic;">**Key:** Using the right phrases is key!</li>
            </ul>
        </div>
      </div>

      <!-- Slide 3: Choral Reading (Giving Opinions) -->
      <div class="slide" id="slide3">
        <h3>III. Choral Reading: Giving Opinions</h3>
        <p>Let's practice how to state your opinion clearly. Please listen and repeat.</p>
        
        <img src="images/lesson-22-slide3-opinions.png"
             alt="Graphic of a speech bubble with a plus sign or 'agree' icon"
             class="placeholder-image"
             style="max-width: 300px;"
             onerror="this.src='https://placehold.co/300x200/cccccc/ffffff?text=Giving+Opinions'; this.alt='Error loading image';">

        <h4>Key Phrases (Strong to Soft)</h4>
        <!-- No reveal needed here, as requested -->
        <ul>
            <li>"In my opinion, we should..." <button class="audio-button" onclick="speakPhrase('In my opinion, we should focus on quality.')">Listen</button></li>
            <li>"I believe that..." <button class="audio-button" onclick="speakPhrase('I believe that the new process is too slow.')">Listen</button></li>
            <li>"I think we need to..." <button class="audio-button" onclick="speakPhrase('I think we need to reschedule the delivery.')">Listen</button></li>
            <li>"I feel that..." <button class="audio-button" onclick="speakPhrase('I feel that the team is doing a great job.')">Listen</button></li>
            <li>"From my perspective,..." <button class="audio-button" onclick="speakPhrase('From my perspective, we have enough inventory.')">Listen</button></li>
            <li>"It seems to me that..." <button class="audio-button" onclick="speakPhrase('It seems to me that the problem is the wire size.')">Listen</button></li>
        </ul>
        
        <h4>Industry Example:</h4>
        <p><code>"I think</code> we should test the new winding machine today."</p>
      </div>

      <!-- Slide 4: Choral Reading (Disagreeing Politely) -->
      <div class="slide" id="slide4">
        <h3>IV. Choral Reading: Disagreeing Politely</h3>
        <p>This is the most important skill. You must show you heard the other person *before* you disagree. Please listen and repeat.</p>

        <img src="images/lesson-22-slide4-disagree.png"
             alt="Graphic of two speech bubbles interacting, one with a question"
             class="placeholder-image"
             style="max-width: 350px;"
             onerror="this.src='https://placehold.co/350x200/cccccc/ffffff?text=Polite+Disagree'; this.alt='Error loading image';">

        <div class="phrase-list">
            <div class="topic-disagree">
                <h4>"Soft" Disagreement</h4>
                <ul>
                    <li>"I'm not sure I agree..." <button class="audio-button" onclick="speakPhrase('I\'m not sure I agree with that timeline.')">Listen</button></li>
                    <li>"I see what you mean, but..." <button class="audio-button" onclick="speakPhrase('I see what you mean, but the cost is too high.')">Listen</button></li>
                    <li>"I understand your point, however..." <button class="audio-button" onclick="speakPhrase('I understand your point, however, the report deadline is firm.')">Listen</button></li>
                </ul>
            </div>
            <div class="topic-disagree">
                <h4>"Questioning" Disagreement</h4>
                <ul>
                    <li>"Have you considered...?" <button class="audio-button" onclick="speakPhrase('Have you considered using the new supplier?')">Listen</button></li>
                    <li>"What about...?" <button class="audio-button" onclick="speakPhrase('What about the overtime budget?')">Listen</button></li>
                    <li>"I'm not sure. What if we...?" <button class="audio-button" onclick="speakPhrase('I\'m not sure. What if we delay assembly by one day?')">Listen</button></li>
                </ul>
            </div>
        </div>
        
        <h4 style="margin-top: 1rem;">Industry Example Practice (Click to Reveal):</h4>
        
        <!-- Example 1 -->
        <p>Person A: "I think we should stop quality checks."</p>
        <div class="reveal-container" style="border-left-color: #059669; background-color: #d1fae5;">
            <div class="reveal-controls">
                <button onclick="revealText('example1')">Reveal Polite Disagreement</button>
            </div>
            <p id="example1" class="revealable-text">You: "**I see your point, but** quality is critical for our customers."</p>
        </div>

        <!-- Example 2 (New) -->
        <p style="margin-top: 1.5rem;">Person A: "We should use the cheapest transformer core."</p>
        <div class="reveal-container" style="border-left-color: #059669; background-color: #d1fae5;">
            <div class="reveal-controls">
                <button onclick="revealText('example2')">Reveal Questioning Disagreement</button>
            </div>
            <p id="example2" class="revealable-text">You: "**Have you considered** the long-term impact on machine performance?"</p>
        </div>
        
        <!-- Example 3 (New) -->
        <p style="margin-top: 1.5rem;">Person A: "I believe the report deadline should be tomorrow."</p>
        <div class="reveal-container" style="border-left-color: #059669; background-color: #d1fae5;">
            <div class="reveal-controls">
                <button onclick="revealText('example3')">Reveal Soft Disagreement</button>
            </div>
            <p id="example3" class="revealable-text">You: "**I'm not sure I agree.** I feel we need at least two more days for final data analysis.</p>
        </div>
      </div>

      <!-- Slide 5: Game -->
      <div class="slide" id="slide5">
        <h3>V. Game: "Debateable"</h3>
        <p>Now, let's practice using these phrases in a fun game!</p>
        
        <img src="images/lesson-22-slide5-game.png"
             alt="Illustration of 'Debateable' game cards or people debating"
             class="placeholder-image"
             style="max-width: 450px;"
             onerror="this.src='https://placehold.co/450x250/cccccc/ffffff?text=Debateable+Game'; this.alt='Error loading image';">

        <h4>How to Play:</h4>
        <ul>
            <li>Get into small groups.</li>
            <li>Your teacher will give you a "Debateable" card with a topic.</li>
            <li>One person will give their opinion on the topic.</li>
            <li>The next person must *politely disagree* using one of our new phrases.</li>
            <li>Take turns. Try to have a polite 2-minute debate!</li>
        </ul>
        <p><strong>Listen for:</strong> "I think...", "In my opinion...", "I see your point, but...", "Have you considered..."</p>
      </div>

      <!-- Slide 6: Wrap-up -->
      <div class="slide" id="slide6">
        <h3>VI. Wrap-up & Next Steps</h3>
        <p>Fantastic job today! You all did very well navigating difficult topics politely.</p>

        <img src="images/lesson-22-slide6-wrapup.png"
             alt="Icon of a lightbulb and a checkmark for key ideas"
             class="placeholder-image"
             style="max-width: 300px;"
             onerror="this.src='https://placehold.co/300x150/cccccc/ffffff?text=Key+Ideas'; this.alt='Error loading image';">

        <h4>Key Takeaways (Click to reveal one at a time):</h4>
        <div class="reveal-controls" id="slide6-controls-keys">
            <button onclick="revealNext('slide6-reveals-keys')">Reveal Next Takeaway</button>
        </div>
        <ul id="slide6-reveals-keys" style="list-style: none; padding-left: 0;">
            <li class="revealable-text" data-order="1">**1.** Different opinions are **good** for the team.</li>
            <li class="revealable-text" data-order="2">**2.** Always be **respectful** and **professional**.</li>
            <li class="revealable-text" data-order="3">**3.** First, show you **understand** ("I see your point...").</li>
            <li class="revealable-text" data-order="4">**4.** Then, give your opinion ("...but I feel...").</li>
        </ul>
        
        <h4 style="margin-top: 1.5rem;">Discussion:</h4>
        <p>Why is it *difficult* to disagree politely in a second language?</p>
        
        <div class="reveal-container" style="border-left-color: #059669; background-color: #d1fae5;">
            <div class="reveal-controls" id="slide6-controls-disc">
                <button onclick="revealNext('slide6-reveals-disc')">Brainstorm Answers</button>
            </div>
            <ul id="slide6-reveals-disc" style="list-style: disc; margin-left: 1.5rem; margin-top: 0; padding-left: 0;">
                <li class="revealable-text" data-order="1" style="list-style: disc;">You may confuse direct translation (Thai to English) with polite phrasing.</li>
                <li class="revealable-text" data-order="2" style="list-style: disc;">You lack confidence in advanced vocabulary, so you use short, simple (and sometimes direct) words.</li>
                <li class="revealable-text" data-order="3" style="list-style: disc;">You might be afraid of mispronouncing the longer, softer phrases.</li>
            </ul>
        </div>

        <!-- Link to the video/quiz page -->
        <a href="videos.html#lesson22" class="button-link" style="margin-top: 1.5rem;">Go to Lesson 22 Video & Quiz</a>
        <!-- New back button -->
        <a href="lessons.html" class="button-link" style="margin-top: 1rem; background-color: #6b7280;">Back to Lessons List</a>
      </div>

      <!-- Navigation -->
      <div class="slide-nav">
        <button id="prevBtn" onclick="changeSlide(-1)" disabled>Previous</button>
        <span id="slide-counter">Slide 1 of 6</span>
        <button id="nextBtn" onclick="changeSlide(1)">Next</button>
      </div>

    </div> <!-- End Slideshow Container -->
    
    <!-- The Modal Structure (Hidden by default) -->
    <div id="opinionModal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeModal('opinionModal')">&times;</span>
        <h3>What is a "Different Opinion"?</h3>
        <p>
            When two people have a **different opinion**, it means they have different ideas, beliefs, or thoughts about the same topic.
        </p>
        <p>
            **Example:** Person A thinks **chocolate** is the best flavor. Person B has a different opinion and thinks **vanilla** is the best flavor.
        </p>
        <p>
            In the workplace, it means having different ideas on how to solve a problem or what the best plan is.
        </p>
      </div>
    </div>
    
  </main>

  <footer>
    <p>&copy; 2025 Dan Mills</p>
  </footer>

  <script src="js/app.js"></script>
  <script type="module">
    // --- Slideshow Logic ---
    let currentSlide = 1;
    const totalSlides = 6;
    const slides = document.querySelectorAll('.slide');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const counter = document.getElementById('slide-counter');
    
    // --- SLIDE JUMP LOGIC ---
    // Check URL parameters for a starting slide
    const urlParams = new URLSearchParams(window.location.search);
    const startSlide = urlParams.get('slide');
    if (startSlide && !isNaN(parseInt(startSlide))) {
        currentSlide = Math.min(Math.max(1, parseInt(startSlide)), totalSlides);
    }
    // --- END SLIDE JUMP LOGIC ---

    // Function to manage sequential reveals
    let revealState = {}; // Tracks the next point to reveal for each container
    
    // *** NEW FUNCTION: Handles the direct reveal (used for Slide 4 Industry Examples) ***
    window.revealText = function(elementId) {
        const element = document.getElementById(elementId);
        if (element) {
            element.style.display = 'block';
            // Optional: Disable the button after click to prevent multiple reveals
            const button = element.closest('.reveal-container').querySelector('.reveal-controls button[onclick*="' + elementId + '"]');
            if (button) {
                 button.disabled = true;
                 button.textContent = 'Revealed';
            }
        }
    }


    window.revealNext = function(containerId) {
        const container = document.getElementById(containerId);
        if (!container) return;

        // Initialize or get the current step
        if (!revealState[containerId]) {
            revealState[containerId] = 1;
        }

        const nextPoint = container.querySelector(`.revealable-text[data-order="${revealState[containerId]}"]`);
        if (nextPoint) {
            nextPoint.style.display = 'list-item'; // or 'block'
            // Check if there is a next point after this one
            const nextNextPoint = container.querySelector(`.revealable-text[data-order="${revealState[containerId] + 1}"]`);
            if (nextNextPoint) {
                revealState[containerId]++;
            } else {
                // If this was the last point, disable the button
                const controlButton = document.querySelector(`#${containerId}`).previousElementSibling.querySelector('button');
                if (controlButton) {
                    controlButton.disabled = true;
                    controlButton.textContent = 'All Points Revealed';
                }
            }
        }
    }

    // Function to reset all revealable elements on slide change
    function resetReveals() {
        document.querySelectorAll('.revealable-text').forEach(el => {
            el.style.display = 'none';
        });
        document.querySelectorAll('.reveal-controls button').forEach(button => {
            button.disabled = false;
            // Restore original button text based on the container ID context
            if (button.closest('#slide2-controls')) {
                button.textContent = 'Reveal Next Point';
            } else if (button.closest('#slide4')) {
                // This targets the three specific buttons on slide 4
                button.textContent = 'Reveal Polite Disagreement'; 
            } else if (button.closest('#slide6-controls-keys')) {
                 button.textContent = 'Reveal Next Takeaway';
            } else if (button.closest('#slide6-controls-disc')) {
                 button.textContent = 'Brainstorm Answers';
            }
        });
        revealState = {}; // Reset tracking state
    }

    function showSlide(n) {
      slides.forEach(slide => slide.classList.remove('active'));
      const currentSlideElement = document.getElementById(`slide${n}`);
      if (currentSlideElement) {
          currentSlideElement.classList.add('active');
      }
      counter.textContent = `Slide ${n} of ${totalSlides}`;
      prevBtn.disabled = (n === 1);
      nextBtn.disabled = (n === totalSlides);
      
      // Always reset reveals when showing a new slide
      resetReveals();
    }

    window.changeSlide = function(n) {
      currentSlide += n;
      if (currentSlide < 1) currentSlide = 1;
      if (currentSlide > totalSlides) currentSlide = totalSlides;
      showSlide(currentSlide);
    }
    showSlide(currentSlide);
    
    // --- Modal Logic ---
    window.showModal = function(modalId) {
        document.getElementById(modalId).style.display = 'block';
    }

    window.closeModal = function(modalId) {
        document.getElementById(modalId).style.display = 'none';
    }

    window.onclick = function(event) {
      const modal = document.getElementById('opinionModal');
      if (event.target == modal) {
        modal.style.display = 'none';
      }
    }

    // --- Audio Logic (Web Speech API) ---
    window.speakPhrase = function(phrase) {
      if ('speechSynthesis' in window) {
        const utterance = new SpeechSynthesisUtterance(phrase);
        utterance.lang = 'en-US'; 
        const voices = window.speechSynthesis.getVoices();
        const enVoice = voices.find(voice => voice.lang === 'en-US' && voice.name.includes('Female'));
        if (enVoice) {
            utterance.voice = enVoice;
        }

        if (!window.speechSynthesis.speaking) {
            window.speechSynthesis.speak(utterance);
        }
      } else {
        console.warn("Browser does not support Speech Synthesis for audio playback.");
      }
    }

    // --- Logout Button Logic ---
    import { auth, signOut } from './js/firebase-init.js';
    document.body.classList.remove('auth-loading'); // Show body

    const logoutButton = document.getElementById('logout-button');
    if (logoutButton) {
        logoutButton.addEventListener('click', () => {
        signOut(auth).then(() => {
            window.location.href = 'login.html';
        }).catch((error) => {
            console.error("Sign out error:", error);
        });
        });
    }
  </script>
</body>
</html>
